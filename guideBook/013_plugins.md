Loader 就是负责完成项目中各种各样资源模块的加载，从而实现整体项目的模块化

Plugin 则是用来解决项目中除了资源模块打包以外的其他自动化工作，如：
+ 实现自动在打包之前清除 dist 目录（上次的打包结果）；
+ 自动生成应用所需要的 HTML 文件；
+ 根据不同环境为代码注入类似 API 地址这种可能变化的部分；
+ 拷贝不需要参与打包的资源文件到输出目录；
+ 压缩 Webpack 打包完成后输出的文件；
+ 自动发布打包结果到服务器实现自动部署。

常见的插件：
+ 自动清除输出目录的插件 clean-webpack-plugin
+ 自动生成使用打包结果的HTML(HTML 中自动注入 Webpack 打包生成的 bundle) html-webpack-plugin
+ 用于复制文件的插件 copy-webpack-plugin 
+ 压缩输出的图片 imagemin webpack plugin

对于同时输出多个 HTML，会配合 Webpack 多入口打包的用法，这样就可以让不同的 HTML 使用不同的打包结果。后续再补充

相比于 Loader，插件的能力范围更宽，因为 Loader 只是在模块的加载环节工作，而插件的作用范围几乎可以触及 Webpack 工作的每一个环节。Webpack 的插件机制就是在软件开发中最常见的钩子机制。钩子机制也特别容易理解，它有点类似于 Web 中的事件。在 Webpack 整个工作过程会有很多环节，为了便于插件的扩展，Webpack 几乎在每一个环节都埋下了一个钩子。在开发插件的时候，通过往这些不同节点上挂载不同的任务，就可以轻松扩展 Webpack 的能力。具体有哪些预先定义好的钩子，可以参考官方文档的 API：
+ [compiler-hooks](https://webpack.js.org/api/compiler-hooks/)
+ [compilation-hooks](https://webpack.js.org/api/compilation-hooks/)
+ [JavascriptParser Hooks](https://webpack.js.org/api/parser/)

# 自己做一个删除注释的插件
1. Webpack 要求插件必须是一个函数或者是一个包含 apply 方法的对象，一般会定义一个类型，在这个类型中定义 apply 方法。然后在使用时，再通过这个类型来创建一个实例对象去使用这个插件
2. 定义一个 RemoveCommentsPlugin 类型，然后在这个类型中定义一个 apply 方法，这个方法会在 Webpack 启动时被调用，它接收一个 compiler 对象参数，这个对象是 Webpack 工作过程中最核心的对象，里面包含了此次构建的所有配置信息，通过这个对象去注册钩子函数
3. 明确任务的执行时机，也就是到底应该把这个任务挂载到哪个钩子上。需求是删除 bundle.js 中的注释，也就是说只有当 Webpack 需要生成的 bundle.js 文件内容明确过后才可能实施。根据 API 文档中的介绍，找到一个叫作 emit 的钩子，这个钩子会在 Webpack 即将向输出目录输出文件时执行，符合需求。
4. 通过 compiler 对象的 hooks 属性访问到 emit 钩子，再通过 tap 方法注册一个钩子函数，这个方法接收两个参数
  + 插件的名称，我们这里的插件名称是 RemoveCommentsPlugin
  + 要挂载到这个钩子上的函数
5. 根据 API 文档中的提示，在这个函数中接收一个 compilation 对象参数，这个对象可以理解为此次运行打包的上下文，所有打包过程中产生的结果，都会放到这个对象中。使用这个对象中的 assets 属性获取即将写入输出目录的资源文件信息，它是一个对象，我们这里通过 for in 去遍历这个对象，其中键就是每个文件的名称，尝试把它打印出来。
6. 打印一下每个资源文件的内容，文件内容需要通过遍历的值对象中的 source 方法获取
7. 先判断文件名是不是以 .js 结尾，如果是 JS 文件，我们将文件内容得到，再通过正则替换的方式移除掉代码中的注释，最后覆盖掉 compilation.assets 中对应的对象，在覆盖的对象中，我们同样暴露一个 source 方法用来返回新的内容。另外还需要再暴露一个 size 方法，用来返回内容大小，这是 Webpack 内部要求的格式
8. 总结：插件都是通过往 Webpack 生命周期的钩子中挂载任务函数实现的。Webpack 为每一个工作环节都预留了合适的钩子，我们在扩展时只需要找到合适的时机去做合适的事情就可以了。这种钩子机制又叫作面向切面编程（AOP），是软件工程中实现插件机制最常见的方式，在开发工作中有类似的需求，那钩子机制一定是最好的选择。而且对于使用 JavaScript 的开发者而言，实现面向切面编程其实也很容易，很多时候我们都会采用事件机制去实现这种编程模式。
